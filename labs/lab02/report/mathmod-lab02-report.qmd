---
## Author
author:
  name: Джафар Идрисов
  email: 1132232876@rudn.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6

## Title
title: "Математическое моделирование"
subtitle: "Лабораторная работа № 2"
license: "CC BY"
---

# Цель работы

Рассмотрим типичный пример применения математического моделирования для выбора рациональной стратегии поиска/перехвата.  
Пусть в условиях тумана катер береговой охраны преследует лодку браконьеров. В некоторый момент туман рассеивается, и лодка фиксируется на расстоянии $k$ км от катера. Далее лодка снова скрывается и продолжает движение прямолинейно в неизвестном направлении. Известно, что скорость катера в $n$ раз выше скорости лодки.  
Требуется определить траекторию движения катера, обеспечивающую перехват.

# Задание

1. Выполнить рассуждения и получить дифференциальные уравнения движения при условии, что скорость катера в $n$ раз больше скорости лодки.
2. Построить траектории катера и лодки для двух вариантов начальных условий.
3. По графику определить точку пересечения траекторий (момент встречи).

# Выполнение лабораторной работы

Положим $t_0=0$. Точку обнаружения лодки примем за начало отсчёта.  
Будем считать, что лодка в момент обнаружения находится в точке $X=0$, а катер — на расстоянии $k$ от неё вдоль некоторого направления.

Введём полярную систему координат. Полюс — точка обнаружения лодки: $r=0$. Полярная ось $r$ направлена через текущее положение катера в момент наблюдения.

## Нахождение расстояния $x$ до перехода на «обход полюса»

Пусть через время $t$ и лодка, и катер окажутся на одинаковом расстоянии $x$ от полюса (то есть имеют одинаковый радиус $r=x$).  
За это время лодка проходит путь $x$, а катер — $x-k$ или $x+k$ (в зависимости от взаимного расположения относительно полюса).

Обозначим скорость лодки как $v$, тогда скорость катера равна $nv$.

Для равенства времен движения получаем два случая:

- **Случай 1 (case = plus):**  
  $$
  \frac{x}{v}=\frac{x+k}{nv}.
  $$
- **Случай 2 (case = minus):**  
  $$
  \frac{x}{v}=\frac{x-k}{nv}.
  $$

Отсюда получаем значения радиуса, при которых катер «выравнивается» по расстоянию до полюса с лодкой:

$$
x_1=\frac{k}{n+1},\quad \theta_0=0,
$$

$$
x_2=\frac{k}{n-1},\quad \theta_0=-\pi.
$$

Далее катер должен двигаться так, чтобы не уступать лодке в радиальном удалении от полюса, одновременно «обметая» направления вокруг полюса.

## Разложение скорости катера на компоненты

Скорость катера раскладываем на радиальную и тангенциальную составляющие:

- радиальная скорость:
  $$
  v_r=\frac{dr}{dt};
  $$
- тангенциальная скорость:
  $$
  v_t=r\frac{d\theta}{dt}.
  $$

Чтобы катер сохранял одинаковую с лодкой скорость удаления от полюса, задаём:
$$
\frac{dr}{dt}=v.
$$

Полная скорость катера равна $nv$, следовательно по теореме Пифагора:
$$
(nv)^2=v_r^2+v_t^2.
$$

Так как $v_r=v$, то:
$$
v_t=\sqrt{(nv)^2-v^2}=v\sqrt{n^2-1}.
$$

Отсюда:
$$
r\frac{d\theta}{dt}=v\sqrt{n^2-1}.
$$

Таким образом, исходная динамика сводится к системе ОДУ:

$$
\begin{cases}
\frac{dr}{dt}=v,\\
r\frac{d\theta}{dt}=v\sqrt{n^2-1}.
\end{cases}
$$

### Начальные условия

**Случай (case = plus):**
$$
\begin{cases}
\theta_0=0,\\
r_0=\frac{k}{n+1}.
\end{cases}
$$

**Случай (case = minus):**
$$
\begin{cases}
\theta_0=-\pi,\\
r_0=\frac{k}{n-1}.
\end{cases}
$$

## Переход к уравнению траектории

Исключим $t$ из системы. Делим первое уравнение на второе:

$$
\frac{dr/dt}{d\theta/dt}=\frac{dr}{d\theta}
\quad\Rightarrow\quad
\frac{dr}{d\theta}=\frac{r}{\sqrt{n^2-1}}.
$$

Начальные условия сохраняются (по выбранному случаю). Решение этого уравнения даёт траекторию катера в полярных координатах.

После получения аналитической формы (и/или численного решения) строим траектории катера и лодки для двух наборов начальных данных и определяем точку пересечения.

# Условие задачи

В тумане катер береговой охраны преследует лодку браконьеров. В момент видимости лодка обнаружена на расстоянии $k=20$ км от катера. Затем лодка уходит прямолинейно в неизвестном направлении.  
Известно, что скорость катера в $n=5$ раз больше скорости лодки.

Для моделирования процесса и построения графиков использовались внешние файлы с программным кодом:

{{< include ../project/markdown/01_task_of_chase/01_task_of_chase.qmd >}}

{{< include ../project/markdown/02_task_of_chase/02_task_of_chase.qmd >}}

# Анализ результатов моделирования

В рамках работы выполнено численное исследование движения катера, заданного уравнением

$$
\frac{dr}{d\theta}=\frac{r}{\sqrt{n^2-1}},
$$

а также сопоставление полученной траектории с траекторией лодки, описанной аналитически и представленной в полярных координатах.

## Базовые эксперименты

### 1. Случай (case = plus)

![Базовый эксперимент (case=plus)](image/single_experiment.png)

По полярному графику видно, что траектория катера имеет форму расходящейся спирали: при увеличении угла $\theta$ радиус $r$ монотонно возрастает.  
Поскольку в правой части уравнения стоит $r$, рост по $\theta$ носит экспоненциальный характер.

Траектория лодки соответствует прямолинейному движению в декартовой системе; в полярных координатах это луч (линейная зависимость радиуса от параметра движения).

В рассматриваемой конфигурации катер увеличивает радиус быстрее, что визуально проявляется как расхождение кривых.

### 2. Случай (case = minus)

![Базовый эксперимент (case=minus)](image/single_experiment_minus.png)

Во втором варианте начальный радиус больше, поэтому стартовая точка катера находится дальше от полюса.  
Характер траектории сохраняется (та же «экспоненциальная» спираль), но масштаб траектории смещён наружу.

Следовательно, различие между режимами case=plus и case=minus определяется начальными условиями, а не типом роста.

## Параметрическое сканирование по $n$

![Сканирование траекторий катера](image/parametric_scan_cutter_comparison.png)

Исследовано влияние параметра $n$ на динамику для обоих наборов начальных условий.

Из уравнения видно, что «интенсивность» изменения задаётся коэффициентом

$$
\frac{1}{\sqrt{n^2-1}}.
$$

При увеличении $n$ этот коэффициент уменьшается, поэтому:

- при меньших $n$ спираль расходится заметно быстрее;
- при больших $n$ радиус растёт медленнее;
- траектория становится более «пологой» по углу.

На графике это проявляется в том, что при $n=3$ рост наиболее быстрый, а при $n=10$ — наиболее медленный.

## Анализ метрики scale_ratio

![Зависимость scale_ratio от n](image/scale_ratio_vs_n.png)

Введена метрика относительного масштаба:

$$
\text{scale\_ratio}=\frac{r_{\text{final}}}{\max(r_{\text{boat}})}.
$$

По графику видно:

- для малых $n$ метрика существенно превышает $1$ (катер выраженно превосходит лодку по радиальному масштабу траектории);
- с ростом $n$ значение метрики быстро уменьшается;
- при больших $n$ масштабы траекторий становятся сопоставимыми.

Для режима case=minus метрика выше, что объясняется увеличенным начальным радиусом.

## Время вычислений

![Зависимость времени вычисления от n](image/computation_time_vs_n.png)

Проведён бенчмаркинг численного решения ОДУ для различных значений $n$.

Наблюдения:

- время расчёта порядка $6\times 10^{-4}$ секунды;
- выраженной зависимости от $n$ не выявлено;
- небольшие колебания связаны с адаптивным выбором шага интегрирования и особенностями численной обработки.

# Выводы

1. В полярных координатах траектория катера описывается расходящейся спиралью с экспоненциальным ростом $r$ по углу $\theta$.
2. Параметр $n$ определяет темп роста: чем больше $n$, тем меньше коэффициент $1/\sqrt{n^2-1}$ и тем медленнее увеличивается радиус.
3. Выбор начальных условий (case) влияет на стартовый масштаб траектории, не меняя её качественной формы.
4. Численное решение устойчиво, а вычислительные затраты практически не зависят от параметров модели.

Полученные результаты согласуются со структурой дифференциального уравнения и ожидаемой геометрией траекторий.

# Список литературы {.unnumbered}

1. [Задача о погоне](https://esystem.rudn.ru/pluginfile.php/2290141/mod_resource/content/2/Лабораторная%20работа%20№%201.pdf)
